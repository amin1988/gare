<?phpif (!defined("_BASEDIR_"))    exit();session_start();include_model("Organizzatore", "Gara", "Stage", "Arbitro", "Societa", "Utente");include_model("esterni/ArbitroAffiliato", "esterni/TesseratoFiam", "ArbitroEsterno");include_errori("VerificaGara");class ConvocazioniStageCtrl{    /** @var Organizzatore */    protected $ut;    protected $gara;    private $partecipanti_non_convalidati = NULL;    public function __construct($id_gara)    {        $lang = Lingua::getParole();        $gara = new Gara($id_gara);        $id_u = Utente::getIdAccesso();        $org = Organizzatore::crea($id_u);                $stage =  new Stage(null, 'partecipanti_stage');        $this->partecipanti_non_convalidati = $stage->getPresenzeStage($id_gara, 2);                if ( isset($_POST['stage_nazionale']))        {            $societa_lista = $_POST['stage_nazionale'];            foreach ($societa_lista as $id_societa=>$array_tesserati)            {                for ($i=0; $i<count($array_tesserati);$i++)                {                    $id_tesserato = $array_tesserati[$i];                    $stage = new Stage(null, 'partecipanti_stage');                    $stage->convalidaPresenze($id_gara,$id_societa,$id_tesserato);                }                            }                    }        if (isset($_POST["pageid"]))//ï¿½ stato premuto il pulsante salva        {            $page = $_SERVER["PHP_SELF"] . "?id=$id_gara";            header("Location: $page");        }    }        public function getPartecipanti_non_convalidati()    {        return $this->partecipanti_non_convalidati;    }    public function getGara()    {        return $this->gara;    }}